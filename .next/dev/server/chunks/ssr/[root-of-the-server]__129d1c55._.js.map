{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 14, "column": 0}, "map": {"version":3,"sources":["file:///Users/yerkomunoz/Dev-personal/V0/v0-gym-attendance-app/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient as createSupabaseServerClient } from \"@supabase/ssr\";\nimport { cookies } from \"next/headers\";\n\nexport async function createClient() {\n  const cookieStore = await cookies();\n\n  return createSupabaseServerClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n    {\n      cookies: {\n        getAll() {\n          return cookieStore.getAll();\n        },\n        setAll(cookiesToSet) {\n          try {\n            cookiesToSet.forEach(({ name, value, options }) =>\n              cookieStore.set(name, value, options),\n            );\n          } catch {\n            // The \"setAll\" method was called from a Server Component.\n            // This can be ignored if you have middleware refreshing\n            // user sessions.\n          }\n        },\n      },\n    },\n  );\n}\n\nexport async function createServerClient() {\n  const cookieStore = await cookies();\n\n  return createSupabaseServerClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n    {\n      cookies: {\n        getAll() {\n          return cookieStore.getAll();\n        },\n        setAll(cookiesToSet) {\n          try {\n            cookiesToSet.forEach(({ name, value, options }) =>\n              cookieStore.set(name, value, options),\n            );\n          } catch {\n            // The \"setAll\" method was called from a Server Component.\n            // This can be ignored if you have middleware refreshing\n            // user sessions.\n          }\n        },\n      },\n    },\n  );\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,2SAAO;IAEjC,OAAO,IAAA,4SAA0B,6PAG/B;QACE,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;gBAEjC,EAAE,OAAM;gBACN,0DAA0D;gBAC1D,wDAAwD;gBACxD,iBAAiB;gBACnB;YACF;QACF;IACF;AAEJ;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,2SAAO;IAEjC,OAAO,IAAA,4SAA0B,6PAG/B;QACE,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;gBAEjC,EAAE,OAAM;gBACN,0DAA0D;gBAC1D,wDAAwD;gBACxD,iBAAiB;gBACnB;YACF;QACF;IACF;AAEJ"}},
    {"offset": {"line": 67, "column": 0}, "map": {"version":3,"sources":["file:///Users/yerkomunoz/Dev-personal/V0/v0-gym-attendance-app/components/history-client.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const HistoryClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call HistoryClient() from the server but HistoryClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/history-client.tsx <module evaluation>\",\n    \"HistoryClient\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,gBAAgB,IAAA,yaAAuB,EAChD;IAAa,MAAM,IAAI,MAAM;AAA0O,GACvQ,+DACA","ignoreList":[0]}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["file:///Users/yerkomunoz/Dev-personal/V0/v0-gym-attendance-app/components/history-client.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const HistoryClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call HistoryClient() from the server but HistoryClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/history-client.tsx\",\n    \"HistoryClient\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,gBAAgB,IAAA,yaAAuB,EAChD;IAAa,MAAM,IAAI,MAAM;AAA0O,GACvQ,2CACA","ignoreList":[0]}},
    {"offset": {"line": 95, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 103, "column": 0}, "map": {"version":3,"sources":["file:///Users/yerkomunoz/Dev-personal/V0/v0-gym-attendance-app/components/role-based-nav.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const RoleBasedNav = registerClientReference(\n    function() { throw new Error(\"Attempted to call RoleBasedNav() from the server but RoleBasedNav is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/role-based-nav.tsx <module evaluation>\",\n    \"RoleBasedNav\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,eAAe,IAAA,yaAAuB,EAC/C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,+DACA","ignoreList":[0]}},
    {"offset": {"line": 117, "column": 0}, "map": {"version":3,"sources":["file:///Users/yerkomunoz/Dev-personal/V0/v0-gym-attendance-app/components/role-based-nav.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const RoleBasedNav = registerClientReference(\n    function() { throw new Error(\"Attempted to call RoleBasedNav() from the server but RoleBasedNav is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/role-based-nav.tsx\",\n    \"RoleBasedNav\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,eAAe,IAAA,yaAAuB,EAC/C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,2CACA","ignoreList":[0]}},
    {"offset": {"line": 131, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 139, "column": 0}, "map": {"version":3,"sources":["file:///Users/yerkomunoz/Dev-personal/V0/v0-gym-attendance-app/app/history/page.tsx"],"sourcesContent":["import { createClient } from \"@/lib/supabase/server\";\nimport { HistoryClient } from \"@/components/history-client\";\nimport { RoleBasedNav } from \"@/components/role-based-nav\";\nimport { redirect } from \"next/navigation\";\n\nexport default async function HistoryPage() {\n  const supabase = await createClient();\n\n  // Get current user - use getUser() for server-side authentication\n  const { data: { user }, error: authError } = await supabase.auth.getUser();\n\n  if (authError || !user) {\n    redirect('/login');\n  }\n\n  // Get user profile with role\n  const { data: userProfile } = await supabase\n    .from('users')\n    .select('role, branch_id')\n    .eq('id', user.id)\n    .single();\n\n  if (!userProfile) {\n    redirect('/login');\n  }\n\n  // Build query based on role\n  let query = supabase\n    .from(\"attendance\")\n    .select(\n      `\n      *,\n      trainers (\n        id,\n        name,\n        email,\n        specialty\n      ),\n      students (\n        id,\n        name,\n        branch_id,\n        branches (\n          id,\n          name\n        )\n      )\n    `\n    );\n\n  // Filter based on role\n  if (userProfile.role === 'trainer' && userProfile.branch_id) {\n    // Trainers can only see attendance from their branch\n    query = query.eq('branch_id', userProfile.branch_id);\n  } else if (userProfile.role === 'student') {\n    // Students can only see their own attendance\n    const { data: studentRecord } = await supabase\n      .from('students')\n      .select('id')\n      .eq('user_id', user.id)\n      .single();\n\n    if (studentRecord) {\n      query = query.eq('student_id', studentRecord.id);\n    } else {\n      // If no student record found, return empty array\n      return (\n        <>\n          <RoleBasedNav />\n          <HistoryClient initialAttendance={[]} />\n        </>\n      );\n    }\n  }\n  // Admin sees all attendance (no filter)\n\n  const { data: attendance, error } = await query.order(\"check_in_time\", { ascending: false });\n\n  if (error) {\n    console.error(\"Error fetching attendance:\", error);\n  }\n\n  return (\n    <>\n      <RoleBasedNav />\n      <HistoryClient initialAttendance={attendance || []} />\n    </>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AAAA;;;;;;AAEe,eAAe;IAC5B,MAAM,WAAW,MAAM,IAAA,yIAAY;IAEnC,kEAAkE;IAClE,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IAExE,IAAI,aAAa,CAAC,MAAM;QACtB,IAAA,kWAAQ,EAAC;IACX;IAEA,6BAA6B;IAC7B,MAAM,EAAE,MAAM,WAAW,EAAE,GAAG,MAAM,SACjC,IAAI,CAAC,SACL,MAAM,CAAC,mBACP,EAAE,CAAC,MAAM,KAAK,EAAE,EAChB,MAAM;IAET,IAAI,CAAC,aAAa;QAChB,IAAA,kWAAQ,EAAC;IACX;IAEA,4BAA4B;IAC5B,IAAI,QAAQ,SACT,IAAI,CAAC,cACL,MAAM,CACL,CAAC;;;;;;;;;;;;;;;;;IAiBH,CAAC;IAGH,uBAAuB;IACvB,IAAI,YAAY,IAAI,KAAK,aAAa,YAAY,SAAS,EAAE;QAC3D,qDAAqD;QACrD,QAAQ,MAAM,EAAE,CAAC,aAAa,YAAY,SAAS;IACrD,OAAO,IAAI,YAAY,IAAI,KAAK,WAAW;QACzC,6CAA6C;QAC7C,MAAM,EAAE,MAAM,aAAa,EAAE,GAAG,MAAM,SACnC,IAAI,CAAC,YACL,MAAM,CAAC,MACP,EAAE,CAAC,WAAW,KAAK,EAAE,EACrB,MAAM;QAET,IAAI,eAAe;YACjB,QAAQ,MAAM,EAAE,CAAC,cAAc,cAAc,EAAE;QACjD,OAAO;YACL,iDAAiD;YACjD,qBACE;;kCACE,+YAAC,mJAAY;;;;;kCACb,+YAAC,iJAAa;wBAAC,mBAAmB,EAAE;;;;;;;;QAG1C;IACF;IACA,wCAAwC;IAExC,MAAM,EAAE,MAAM,UAAU,EAAE,KAAK,EAAE,GAAG,MAAM,MAAM,KAAK,CAAC,iBAAiB;QAAE,WAAW;IAAM;IAE1F,IAAI,OAAO;QACT,QAAQ,KAAK,CAAC,8BAA8B;IAC9C;IAEA,qBACE;;0BACE,+YAAC,mJAAY;;;;;0BACb,+YAAC,iJAAa;gBAAC,mBAAmB,cAAc,EAAE;;;;;;;;AAGxD"}}]
}