{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/yerkomunoz/Dev-personal/V0/v0-gym-attendance-app/lib/contexts/branch-context.tsx"],"sourcesContent":["'use client';\n\nimport { createContext, useContext, useState, useEffect, ReactNode } from 'react';\n\ninterface Branch {\n  id: string;\n  name: string;\n  address: string | null;\n  phone: string | null;\n  active: boolean;\n  created_at: string;\n}\n\ninterface BranchContextType {\n  selectedBranch: Branch | null;\n  setSelectedBranch: (branch: Branch | null) => void;\n  branches: Branch[];\n  setBranches: (branches: Branch[]) => void;\n}\n\nconst BranchContext = createContext<BranchContextType | undefined>(undefined);\n\nexport function BranchProvider({ children }: { children: ReactNode }) {\n  const [selectedBranch, setSelectedBranchState] = useState<Branch | null>(null);\n  const [branches, setBranches] = useState<Branch[]>([]);\n\n  // Load selected branch from localStorage on mount\n  useEffect(() => {\n    const saved = localStorage.getItem('selectedBranch');\n    if (saved) {\n      try {\n        setSelectedBranchState(JSON.parse(saved));\n      } catch (e) {\n        console.error('Error loading selected branch:', e);\n      }\n    }\n  }, []);\n\n  const setSelectedBranch = (branch: Branch | null) => {\n    setSelectedBranchState(branch);\n    if (branch) {\n      localStorage.setItem('selectedBranch', JSON.stringify(branch));\n    } else {\n      localStorage.removeItem('selectedBranch');\n    }\n  };\n\n  return (\n    <BranchContext.Provider value={{ selectedBranch, setSelectedBranch, branches, setBranches }}>\n      {children}\n    </BranchContext.Provider>\n  );\n}\n\nexport function useBranch() {\n  const context = useContext(BranchContext);\n  if (context === undefined) {\n    throw new Error('useBranch must be used within a BranchProvider');\n  }\n  return context;\n}\n"],"names":[],"mappings":";;;;;;;AAEA;;;AAFA;;AAoBA,MAAM,8BAAgB,IAAA,6SAAa,EAAgC;AAE5D,SAAS,eAAe,EAAE,QAAQ,EAA2B;;IAClE,MAAM,CAAC,gBAAgB,uBAAuB,GAAG,IAAA,wSAAQ,EAAgB;IACzE,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,wSAAQ,EAAW,EAAE;IAErD,kDAAkD;IAClD,IAAA,ySAAS;oCAAC;YACR,MAAM,QAAQ,aAAa,OAAO,CAAC;YACnC,IAAI,OAAO;gBACT,IAAI;oBACF,uBAAuB,KAAK,KAAK,CAAC;gBACpC,EAAE,OAAO,GAAG;oBACV,QAAQ,KAAK,CAAC,kCAAkC;gBAClD;YACF;QACF;mCAAG,EAAE;IAEL,MAAM,oBAAoB,CAAC;QACzB,uBAAuB;QACvB,IAAI,QAAQ;YACV,aAAa,OAAO,CAAC,kBAAkB,KAAK,SAAS,CAAC;QACxD,OAAO;YACL,aAAa,UAAU,CAAC;QAC1B;IACF;IAEA,qBACE,4TAAC,cAAc,QAAQ;QAAC,OAAO;YAAE;YAAgB;YAAmB;YAAU;QAAY;kBACvF;;;;;;AAGP;GA9BgB;KAAA;AAgCT,SAAS;;IACd,MAAM,UAAU,IAAA,0SAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;IANgB"}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///Users/yerkomunoz/Dev-personal/V0/v0-gym-attendance-app/lib/supabase/client.ts"],"sourcesContent":["import { createBrowserClient as createSupabaseBrowserClient } from \"@supabase/ssr\";\n\nexport function createClient() {\n  return createSupabaseBrowserClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n  );\n}\n\nexport function createBrowserClient() {\n  return createSupabaseBrowserClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n  );\n}\n"],"names":[],"mappings":";;;;;;AAII;AAJJ;AAAA;;AAEO,SAAS;IACd,OAAO,IAAA,iTAA2B;AAIpC;AAEO,SAAS;IACd,OAAO,IAAA,iTAA2B;AAIpC"}},
    {"offset": {"line": 99, "column": 0}, "map": {"version":3,"sources":["file:///Users/yerkomunoz/Dev-personal/V0/v0-gym-attendance-app/lib/contexts/auth-context.tsx"],"sourcesContent":["'use client';\n\nimport { createContext, useContext, useEffect, useState, ReactNode } from 'react';\nimport { createClient } from '@/lib/supabase/client';\nimport { User as SupabaseUser } from '@supabase/supabase-js';\nimport { User, UserRole } from '@/lib/types';\nimport { useRouter } from 'next/navigation';\n\ninterface AuthContextType {\n    user: User | null;\n    supabaseUser: SupabaseUser | null;\n    loading: boolean;\n    signIn: (email: string, password: string) => Promise<{ error: Error | null }>;\n    signOut: () => Promise<void>;\n    isAdmin: boolean;\n    isTrainer: boolean;\n    isStudent: boolean;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n    const [user, setUser] = useState<User | null>(null);\n    const [supabaseUser, setSupabaseUser] = useState<SupabaseUser | null>(null);\n    const [loading, setLoading] = useState(true);\n    const router = useRouter();\n    const supabase = createClient();\n\n    useEffect(() => {\n        // Get initial session\n        const initializeAuth = async () => {\n            try {\n                const { data: { session } } = await supabase.auth.getSession();\n\n                if (session?.user) {\n                    setSupabaseUser(session.user);\n                    await fetchUserProfile(session.user.id);\n                }\n            } catch (error) {\n                console.error('Error initializing auth:', error);\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        initializeAuth();\n\n        // Listen for auth changes\n        const { data: { subscription } } = supabase.auth.onAuthStateChange(\n            async (event, session) => {\n                if (session?.user) {\n                    setSupabaseUser(session.user);\n                    await fetchUserProfile(session.user.id);\n                } else {\n                    setSupabaseUser(null);\n                    setUser(null);\n                }\n                setLoading(false);\n            }\n        );\n\n        return () => {\n            subscription.unsubscribe();\n        };\n    }, []);\n\n    const fetchUserProfile = async (userId: string) => {\n        try {\n            console.log('üîç Fetching user profile for ID:', userId);\n\n            const { data, error } = await supabase\n                .from('users')\n                .select(`\n          *,\n          branches (\n            id,\n            name,\n            address,\n            phone,\n            active,\n            created_at\n          )\n        `)\n                .eq('id', userId)\n                .single();\n\n            if (error) {\n                console.error('‚ùå Error fetching user profile:', {\n                    message: error.message,\n                    details: error.details,\n                    hint: error.hint,\n                    code: error.code\n                });\n\n                // Si el error es que no se encontr√≥ el usuario\n                if (error.code === 'PGRST116') {\n                    console.error('‚ö†Ô∏è Usuario no encontrado en tabla users. El usuario existe en auth.users pero no tiene perfil en public.users');\n                    console.error('üí° Soluci√≥n: Ejecuta el script scripts/fix_missing_users.sql en Supabase SQL Editor');\n                }\n\n                return;\n            }\n\n            console.log('‚úÖ User profile loaded:', { email: data.email, role: data.role });\n            setUser(data);\n\n            // Auto-set branch for trainers and students\n            if (data.branches && (data.role === 'trainer' || data.role === 'student')) {\n                console.log('üè¢ Auto-setting branch for', data.role, ':', data.branches.name);\n                // We need to use the branch context here, but we can't call useBranch in this function\n                // So we'll set it in a useEffect instead\n            }\n        } catch (error) {\n            console.error('‚ùå Exception fetching user profile:', error);\n        }\n    };\n\n    const signIn = async (email: string, password: string) => {\n        try {\n            const { data, error } = await supabase.auth.signInWithPassword({\n                email,\n                password,\n            });\n\n            if (error) {\n                return { error };\n            }\n\n            if (data.user) {\n                setSupabaseUser(data.user);\n                await fetchUserProfile(data.user.id);\n            }\n\n            return { error: null };\n        } catch (error) {\n            return { error: error as Error };\n        }\n    };\n\n    const signOut = async () => {\n        try {\n            await supabase.auth.signOut();\n            setUser(null);\n            setSupabaseUser(null);\n            router.push('/login');\n        } catch (error) {\n            console.error('Error signing out:', error);\n        }\n    };\n\n    const isAdmin = user?.role === 'admin';\n    const isTrainer = user?.role === 'trainer';\n    const isStudent = user?.role === 'student';\n\n    return (\n        <AuthContext.Provider\n            value={{\n                user,\n                supabaseUser,\n                loading,\n                signIn,\n                signOut,\n                isAdmin,\n                isTrainer,\n                isStudent,\n            }}\n        >\n            {children}\n        </AuthContext.Provider>\n    );\n}\n\nexport function useAuth() {\n    const context = useContext(AuthContext);\n    if (context === undefined) {\n        throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 284, "column": 0}, "map": {"version":3,"sources":["file:///Users/yerkomunoz/Dev-personal/V0/v0-gym-attendance-app/components/branch-auto-setter.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect } from 'react';\nimport { useAuth } from '@/lib/contexts/auth-context';\nimport { useBranch } from '@/lib/contexts/branch-context';\n\n/**\n * Component to auto-set branch for trainers and students\n * This must be a child of both AuthProvider and BranchProvider\n */\nexport function BranchAutoSetter() {\n    const { user } = useAuth();\n    const { setSelectedBranch } = useBranch();\n\n    useEffect(() => {\n        if (user && user.branches && (user.role === 'trainer' || user.role === 'student')) {\n            console.log('üè¢ Auto-setting branch for', user.role, ':', user.branches.name);\n            setSelectedBranch(user.branches);\n        }\n    }, [user, setSelectedBranch]);\n\n    return null; // This component doesn't render anything\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;AAJA;;;;AAUO,SAAS;;IACZ,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,iJAAO;IACxB,MAAM,EAAE,iBAAiB,EAAE,GAAG,IAAA,qJAAS;IAEvC,IAAA,ySAAS;sCAAC;YACN,IAAI,QAAQ,KAAK,QAAQ,IAAI,CAAC,KAAK,IAAI,KAAK,aAAa,KAAK,IAAI,KAAK,SAAS,GAAG;gBAC/E,QAAQ,GAAG,CAAC,8BAA8B,KAAK,IAAI,EAAE,KAAK,KAAK,QAAQ,CAAC,IAAI;gBAC5E,kBAAkB,KAAK,QAAQ;YACnC;QACJ;qCAAG;QAAC;QAAM;KAAkB;IAE5B,OAAO,MAAM,yCAAyC;AAC1D;GAZgB;;QACK,iJAAO;QACM,qJAAS;;;KAF3B"}}]
}